<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Đăng bài viết | TNews</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/style.css" />
    <style>
      /* Fix lỗi placeholder cho div contenteditable */
      #editor:empty:before {
        content: attr(data-placeholder);
        color: #6c757d;
        font-style: italic;
      }

      #editor:focus {
        outline: none;
        border-color: #ffc107 !important;
        box-shadow: 0 0 0 0.25rem rgba(255, 193, 7, 0.25);
      }

      .toolbar-btn {
        min-width: 40px;
      }
    </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg sticky-top shadow">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="../index.html">
          <i id="logo-icon" class="fa-solid fa-newspaper me-1"></i>
          <span id="logo-text">TNews</span>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Trang chủ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Tin tức đăng</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" id="create-post-btn" href="./post.html"
                >Tạo tin tức</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" id="login-btn" href="./login.html"
                >Đăng nhập</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link d-none" id="logout-btn" href="../index.html"
                >Đăng xuất</a
              >
            </li>
          </ul>

          <div class="d-flex align-items-center gap-2">
            <form class="d-flex" role="search">
              <input
                class="form-control"
                type="search"
                placeholder="Tìm kiếm..."
                aria-label="Search"
              />
            </form>
            <button id="theme-toggle" class="btn btn-outline-secondary">
              <i id="theme-icon" class="fa-solid fa-moon"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <main class="container my-4">
      <div class="p-4 rounded shadow-sm border bg-light">
        <div class="row align-items-center mb-4">
          <div class="col-md-8">
            <input
              id="post-title"
              class="form-control border-0 fs-3 fw-bold bg-transparent p-0 mb-2"
              placeholder="Nhập tiêu đề bài viết tại đây..."
            />
            <input
              id="post-thumbnail"
              class="form-control form-control-sm border-0 bg-transparent p-0 text-muted"
              placeholder="Link ảnh thumbnail (URL)..."
            />
          </div>
          <div class="col-md-4 text-md-end mt-3 mt-md-0">
            <button class="btn btn-warning fw-bold px-4 me-1" id="post">
              Đăng bài
            </button>

            <button
              class="btn btn-outline-secondary mt-3 mt-md-0 d-none"
              id="delete-post-btn"
            >
              Xoá bài viết
            </button>
            <button
              class="btn btn-outline-danger"
              onclick="window.history.back()"
            >
              Hủy
            </button>
          </div>
        </div>

        <div id="short-desc">
          <textarea
            id="post-short-desc"
            class="form-control mb-3"
            rows="3"
            placeholder="Nhập mô tả ngắn về bài viết..."
          ></textarea>
        </div>

        <div class="d-flex flex-wrap gap-2 mb-3 bg-white p-2 border rounded">
          <select
            id="font-style"
            class="form-select w-auto form-select-sm"
            onchange="formatHeader(this.value)"
          >
            <option value="p">Văn bản thường</option>
            <option value="h1">Tiêu đề 1</option>
            <option value="h2">Tiêu đề 2</option>
            <option value="h3">Tiêu đề 3</option>
          </select>

          <div class="btn-group">
            <button
              class="btn btn-outline-secondary toolbar-btn"
              onclick="execCmd('bold')"
              title="In đậm"
            >
              <i class="fa-solid fa-bold"></i>
            </button>
            <button
              class="btn btn-outline-secondary toolbar-btn"
              onclick="execCmd('italic')"
              title="In nghiêng"
            >
              <i class="fa-solid fa-italic"></i>
            </button>
            <button
              class="btn btn-outline-secondary toolbar-btn"
              onclick="execCmd('underline')"
              title="Gạch chân"
            >
              <i class="fa-solid fa-underline"></i>
            </button>
          </div>

          <div class="btn-group">
            <button
              class="btn btn-outline-secondary toolbar-btn"
              onclick="execCmd('insertUnorderedList')"
              title="Danh sách"
            >
              <i class="fa-solid fa-list-ul"></i>
            </button>
            <button
              class="btn btn-outline-secondary toolbar-btn"
              onclick="insertImage()"
              title="Chèn ảnh"
            >
              <i class="fa-solid fa-image"></i>
            </button>
          </div>
        </div>

        <div
          id="editor"
          contenteditable="true"
          class="form-control bg-white p-3 w-100"
          style="min-height: 400px; overflow-y: auto"
          data-placeholder="Bắt đầu viết nội dung tin tức của bạn..."
        ></div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script type="module" src="../js/nav.js"></script> -->
    <script type="module" src="../js/post_controller.js"></script>
    <script>
      // Các hàm hỗ trợ nhanh cho editor (có thể đưa vào file post.js)
      function execCmd(command) {
        document.execCommand(command, false, null);
      }

      function formatHeader(value) {
        document.execCommand("formatBlock", false, value);
      }

      function insertImage() {
        const url = prompt("Nhập link ảnh (URL):");
        if (url) {
          document.execCommand("insertImage", false, url);
        }
      }
    </script>
  </body>
</html>
